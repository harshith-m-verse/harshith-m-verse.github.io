"use strict";(self.webpackChunk_1at06cs097=self.webpackChunk_1at06cs097||[]).push([["commoncomponents-commentlisting"],{"4twx":(e,t,n)=>{var a=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(n("cDf5")),r=a(n("RIqP")),o=a(n("lwsE")),i=a(n("W8MJ")),u=a(n("PJYZ")),c=a(n("7W2i")),s=a(n("a1gu")),d=a(n("Nsbk")),f=a(n("lSNA")),m=a(n("q1tI")),p=n("jZew"),v=n("KXDi"),E=n("9Gbs");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,f.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var l=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,l)}else n=a.apply(this,arguments);return(0,s.default)(this,n)}}var w=function(e){(0,c.default)(n,e);var t=P(n);function n(e){var a;return(0,o.default)(this,n),a=t.call(this,e),(0,f.default)((0,u.default)(a),"nextPageInProgress",!1),(0,f.default)((0,u.default)(a),"onScrollEnd",(function(){var e=a.state.nextPageUrl;a.setState(g(g({},a.state),{},{loading:!0})),fetch(e).then((function(e){return e.json()})).then((function(e){if(e.code=200){var t,n,l=null==e||null===(t=e.data)||void 0===t?void 0:t.rows,o=[].concat((0,r.default)(a.state.commentDataRows),(0,r.default)(l));a.nextPageInProgress=!1,a.setState({commentData:null==e?void 0:e.data,commentDataRows:o,nextPageUrl:(null==e?void 0:e.data)&&(null==e||null===(n=e.data)||void 0===n?void 0:n.nextPageUrl),loading:!1})}else a.setState({ApiErrorCode:!0,loading:!1})}))})),(0,f.default)((0,u.default)(a),"onCommentClicked",(function(e){e.preventDefault(),e.stopPropagation();var t={id:a.props.dhPostId,deeplinkUrl:v.DhProperties&&v.DhProperties.seo_url?v.DhProperties.seo_url:"http://m.dailyhunt.in/news/india/english/dspark-epaper-dspark/maruti+suzuki+vitara+brezza-newsid-natznencarsm1m350",sectionAndNamespace:"NEWS"},n=t?t.id:void 0,l=t&&"VIDEO"==t.format?"VIDEO":"NEWS",r={section:l,referrer:"STORY_DETAIL",referrerId:n?"storydetail&&"+n:"",commentParams:{namespace:l,id:n}},o=(t?t.deeplinkUrl:"")+"?allComments="+encodeURIComponent(JSON.stringify(r));"undefined"!=typeof newsHuntAction&&newsHuntAction.handleAction(o)})),(0,f.default)((0,u.default)(a),"formatSeconds",(function(e){return e&&a.calculateTimeDiff(e)})),a.state={commentData:"",commentDataRows:[],nextPageUrl:null,ApiErrorCode:!1,short_url:"",currentTab:"",countfordiscussion:0,loading:!0,commentBaseUrl:v.DhProperties.commentBaseUrl?v.DhProperties.commentBaseUrl.replace("<id>",a.props.dhPostId).replace("<itemId>",a.props.dhPostId):"https://ugc-social.dailyhunt.in/sc/v1/comment?namespace=NEWS&id=<id>&itemId=<itemId>&referrerFlow=WEBITEM".replace("<id>",a.props.dhPostId).replace("<itemId>",a.props.dhPostId)},a}return(0,i.default)(n,[{key:"componentDidMount",value:function(){var e=this;this.state.commentBaseUrl&&fetch(this.state.commentBaseUrl).then((function(e){return e.json()})).then((function(t){if(t.code=200){var n,a,l,r,o,i,u;if(t&&null!=t&&t.data&&null!=t&&null!==(n=t.data)&&void 0!==n&&n.rows)if(null!=t&&null!==(r=t.data)&&void 0!==r&&null!==(o=r.rows)&&void 0!==o&&o.length)e.props.emitReviewCount((null==t||null===(i=t.data)||void 0===i||null===(u=i.rows)||void 0===u?void 0:u.length)+" Reviews");else e.props.emitReviewCount("-");e.setState({commentData:null==t?void 0:t.data,commentDataRows:(null==t?void 0:t.data)&&(null==t||null===(a=t.data)||void 0===a?void 0:a.rows),nextPageUrl:(null==t?void 0:t.data)&&(null==t||null===(l=t.data)||void 0===l?void 0:l.nextPageUrl),loading:!1})}else e.setState({ApiErrorCode:!0})})).then((function(){"object"===("undefined"==typeof loadFuncOnScrollEnd?"undefined":(0,l.default)(loadFuncOnScrollEnd))&&loadFuncOnScrollEnd.push((function(){var t;!e.nextPageInProgress&&null!==(t=e.state)&&void 0!==t&&t.nextPageUrl&&(e.nextPageInProgress=!0,e.props.onScrollEnd(),e.nextPageInProgress=!1)}))})).catch((function(e){return console.log(e)}))}},{key:"componentWillUnmount",value:function(){"object"===("undefined"==typeof loadFuncOnScrollEnd?"undefined":(0,l.default)(loadFuncOnScrollEnd))&&(loadFuncOnScrollEnd.length=0)}},{key:"calculateTimeDiff",value:function(e){var t="";if(e){var n=(new Date).getTime()-e;n&&(n/=1e3),t=n<3600?n<60?"1m":Math.round(n/60)+"m":n<86400?parseInt(n/3600)+"hr":parseInt(n/86400)+"d"}return t}},{key:"render",value:function(){var e=this;return m.default.createElement(m.default.Fragment,null,this.props.sectionTitle&&m.default.createElement(p.SeactionHeader,null,m.default.createElement(E.LHS,null,m.default.createElement(p.H2,{id:this.props.sectionId},this.props.sectionTitle)),m.default.createElement(E.RHS,null,m.default.createElement("a",{onClick:function(t){return e.onCommentClicked(t)}},"See All"))),m.default.createElement(I,{formatSeconds:this.formatSeconds,commentDataRows:this.state.commentDataRows,onCommentClicked:this.onCommentClicked}),this.state.loading&&m.default.createElement(p.Loader,null))}}]),n}(m.default.Component);function I(e){var t=e.commentDataRows;return m.default.createElement(m.default.Fragment,null,m.default.createElement(p.ReviewCard,{className:"commonSection",id:"ReviewCard",style:{paddingTop:"0"}},t&&t.map((function(n,a){var l=t&&t[a].userInfo,r=t&&t[a].userInfo&&t[a].userInfo.profilePictureUrl,o=t&&t[a].userInfo&&t[a].userInfo.userName,i=t&&t[a].userInfo&&t[a].time,u=t&&t[a].userInfo&&t[a].text,c=t&&t[a].userInfo&&t[a].replyCount,s=(t&&t.totalLikeCount,t&&t[a].replies);return m.default.createElement(m.default.Fragment,null,null!=l?m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:"reviews clearfix"},m.default.createElement("div",{className:"reviewLeft"},m.default.createElement("div",{className:"reviewPic"},m.default.createElement("img",{src:r.replace("#DH_EMB_IMG_REP#__DHQ_",v.DhProperties.iconSize||"100x200_80"),alt:""})),m.default.createElement("div",{className:"info"},m.default.createElement("span",null,o),m.default.createElement("em",null,e.formatSeconds(i))))),m.default.createElement("div",{className:"reviewBar"},m.default.createElement("div",{className:"singleReview"},m.default.createElement("p",{className:"singleReviewText"},u))),m.default.createElement("div",{className:"reviewInfo clearfix"},m.default.createElement("div",{className:"left"},m.default.createElement("em",null,c," replies")),m.default.createElement("div",{className:"right"})),s&&s.length>0?m.default.createElement(m.default.Fragment,null,s&&s.map((function(t,n){var a=t&&t.userInfo&&t.userInfo.profilePictureUrl,l=t&&t.userInfo&&t.userInfo.userName,r=t&&t.userInfo&&t.time,o=t&&t.userInfo&&t.text,i=t&&t.userInfo&&t.replyCount;return m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{className:"replies",style:{padding:"0 16px"}},m.default.createElement("div",{className:"reviews clearfix"},m.default.createElement("div",{className:"reviewLeft"},m.default.createElement("div",{className:"reviewPic"},m.default.createElement("img",{src:a.replace("#DH_EMB_IMG_REP#__DHQ_",v.DhProperties.iconSize||"100x200_80"),alt:""})),m.default.createElement("div",{className:"info"},l&&m.default.createElement("span",null,l),m.default.createElement("em",null,e.formatSeconds(r))))),m.default.createElement("div",{className:"reviewBar"},m.default.createElement("div",{className:"singleReview"},m.default.createElement("p",{className:"singleReviewText"},o))),m.default.createElement("div",{className:"reviewInfo clearfix"},m.default.createElement("div",{className:"left"},m.default.createElement("em",null,i," replies")),m.default.createElement("div",{className:"right"}))))}))):null):null)}))))}t.default=w}}]);
//# sourceMappingURL=commoncomponents-commentlisting.35edce20.bundle.js.map