{"version":3,"file":"commoncomponents-commentlisting.35edce20.bundle.js","mappings":"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","sources":["webpack://1at06cs097/./commonComponents/CommentListing.js"],"sourcesContent":["// import { toJS } from \"mobx\";\nimport React from \"react\";\nimport { ReviewCard, Loader, H2, SeactionHeader } from \"./general/style/style\";\nimport { DhProperties } from \"../DhProperties\";\nimport { LHS, RHS } from \"./general/style/common\";\n\nclass CommentListing extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      commentData: \"\",\n      commentDataRows: [],\n      nextPageUrl: null,\n      ApiErrorCode: false,\n      short_url: \"\",\n      currentTab: \"\",\n      countfordiscussion: 0,\n      loading: true,\n      commentBaseUrl: DhProperties.commentBaseUrl\n        ? DhProperties.commentBaseUrl\n            .replace(\"<id>\", this.props.dhPostId)\n            .replace(\"<itemId>\", this.props.dhPostId)\n        : \"https://ugc-social.dailyhunt.in/sc/v1/comment?namespace=NEWS&id=<id>&itemId=<itemId>&referrerFlow=WEBITEM\"\n            .replace(\"<id>\", this.props.dhPostId)\n            .replace(\"<itemId>\", this.props.dhPostId),\n    };\n  }\n\n  nextPageInProgress = false;\n\n  componentDidMount() {\n    if (this.state.commentBaseUrl) {\n      fetch(this.state.commentBaseUrl)\n        .then((response) => response.json())\n        .then((data) => {\n          if ((data.code = 200)) {\n            // console.log(\"ugc-social response: \", data);\n            if(data && data?.data && data?.data?.rows){\n              if(data?.data?.rows?.length){\n                this.props.emitReviewCount(data?.data?.rows?.length + \" Reviews\");\n              }else{\n                this.props.emitReviewCount(\"-\");\n              } \n            }\n            this.setState({\n              commentData: data?.data,\n              commentDataRows: data?.data && data?.data?.rows,\n              nextPageUrl: data?.data && data?.data?.nextPageUrl,\n              loading: false,\n            });\n          } else {\n            this.setState({\n              ApiErrorCode: true,\n            });\n          }\n        })\n        .then(()=>{\n          const onScrollEndCB = () => {\n            if (this.nextPageInProgress || !this.state?.nextPageUrl) return;\n            this.nextPageInProgress = true;\n            //console.log(\"CommentListing onScrollEnd Called\");\n            this.props.onScrollEnd();\n            this.nextPageInProgress = false;\n        }\n        typeof(loadFuncOnScrollEnd)===\"object\" && loadFuncOnScrollEnd.push(onScrollEndCB);\n      })\n      .catch(err => console.log(err))\n    }\n  }\n\n  componentWillUnmount() {\n    if (typeof (loadFuncOnScrollEnd) === \"object\") {\n      loadFuncOnScrollEnd.length = 0;      \n    }\n  }\n\n  onScrollEnd = () => {\n    const nextPageUrl = this.state.nextPageUrl;\n    this.setState({\n      ...this.state,\n      loading: true\n    });\n   // console.log(\"CommentListin onScrollEnd Called: \");\n    fetch(nextPageUrl)\n      .then((response) => response.json())\n      .then((data) => {\n        // console.log(\"data.data nextpage\", data.data.rows);\n        if ((data.code = 200)) {\n          let tempRows = data?.data?.rows;\n          let UpdatedRows = [...this.state.commentDataRows, ...tempRows];\n          // console.log(\"UpdatedRows\", UpdatedRows);\n          this.nextPageInProgress = false;\n          this.setState({\n            commentData: data?.data,\n            commentDataRows: UpdatedRows,\n            nextPageUrl: data?.data && data?.data?.nextPageUrl,\n            loading: false,\n          });\n        } else {\n          this.setState({\n            ApiErrorCode: true,\n            loading:false\n          });\n        }\n      });\n  };\n\n  onCommentClicked = (e) => {\n    // console.log(\"Clicked on Comment.\");\n    e.preventDefault();\n    e.stopPropagation();\n    const story = {\n      id: this.props.dhPostId,\n      deeplinkUrl:\n        DhProperties && DhProperties.seo_url\n          ? DhProperties.seo_url\n          : \"http://m.dailyhunt.in/news/india/english/dspark-epaper-dspark/maruti+suzuki+vitara+brezza-newsid-natznencarsm1m350\",\n      sectionAndNamespace: \"NEWS\",\n    };\n\n    const id = story ? story.id : undefined;\n    const sectionAndNamespace = story && story.format == \"VIDEO\" ? \"VIDEO\" : \"NEWS\";\n    const deeplinkUrl = story ? story.deeplinkUrl : \"\";\n    const payload = {\n      section: sectionAndNamespace,\n      referrer: \"STORY_DETAIL\",\n      referrerId: id ? \"storydetail&&\" + id : \"\",\n      commentParams: {\n        namespace: sectionAndNamespace,\n        id: id,\n      },\n    };\n    const commentDeeplink = deeplinkUrl + \"?allComments=\" + encodeURIComponent(JSON.stringify(payload));\n    // console.log(\"handleAction for onCommentClick\", commentDeeplink);\n    typeof newsHuntAction != \"undefined\" && newsHuntAction.handleAction(commentDeeplink);\n  };\n\n  calculateTimeDiff(publishedTimeMs) {\n    var display = \"\";\n    if (publishedTimeMs) {\n      var currentTimeMs = new Date().getTime();\n      var timeMs = currentTimeMs - publishedTimeMs;\n      if (timeMs) timeMs /= 1000;\n      if (timeMs < 3600) {\n        if (timeMs < 60) {\n          display = \"1m\";\n        } else {\n          display = Math.round(timeMs / 60) + \"m\";\n        }\n      } else if (timeMs < 86400) {\n        display = parseInt(timeMs / 3600) + \"hr\";\n      } else {\n        display = parseInt(timeMs / 86400) + \"d\";\n      }\n    }\n    return display;\n  }\n\n  formatSeconds = (time) => {\n    const timeDiff = time && this.calculateTimeDiff(time);\n    return timeDiff;\n  };\n\n  render() {\n    //console.log(\"CommentListing-props: \", toJS(this.props));\n\n    return (\n      <>        \n       {this.props.sectionTitle && <SeactionHeader>\n          <LHS>\n            <H2 id={this.props.sectionId}>{this.props.sectionTitle}</H2>\n          </LHS>\n          <RHS><a onClick={(e)=>this.onCommentClicked(e)}>See All</a></RHS> \n        </SeactionHeader> }\n        \n        <CommentCard\n          formatSeconds={this.formatSeconds}\n          commentDataRows={this.state.commentDataRows}\n          onCommentClicked={this.onCommentClicked}\n        ></CommentCard>\n        {this.state.loading && <Loader />}\n      </>\n    );\n  }\n}\n\nexport default CommentListing;\n\nfunction CommentCard(data) {\n  const commentDataRows = data.commentDataRows;\n  \n  return (\n    <>\n      <ReviewCard className=\"commonSection\" id=\"ReviewCard\" style={{ paddingTop: \"0\" }}>\n        {commentDataRows &&\n          commentDataRows.map((item, i) => {\n            let userInfo = commentDataRows && commentDataRows[i].userInfo;\n            let profileImg =\n              commentDataRows && commentDataRows[i].userInfo && commentDataRows[i].userInfo.profilePictureUrl;\n            const sourceIcon = profileImg;\n            let profileName =\n              commentDataRows && commentDataRows[i].userInfo && commentDataRows[i].userInfo.userName;\n            let time = commentDataRows && commentDataRows[i].userInfo && commentDataRows[i].time;\n            let text = commentDataRows && commentDataRows[i].userInfo && commentDataRows[i].text;\n            let replyCount = commentDataRows && commentDataRows[i].userInfo && commentDataRows[i].replyCount;\n            let totalLikeCount = commentDataRows && commentDataRows.totalLikeCount;\n            let repliesData = commentDataRows && commentDataRows[i].replies;\n            // console.log(\"repliesData\");\n            return (\n              <>\n                {userInfo != undefined ? (\n                  <>\n                    <div className=\"reviews clearfix\">\n                      <div className=\"reviewLeft\">\n                        <div className=\"reviewPic\">\n                          <img\n                            src={sourceIcon.replace(\n                              \"#DH_EMB_IMG_REP#__DHQ_\",\n                              DhProperties.iconSize || \"100x200_80\"\n                            )}\n                            alt=\"\"\n                          />\n                        </div>\n                        <div className=\"info\">\n                          <span>{profileName}</span>\n                          <em>{data.formatSeconds(time)}</em>\n                        </div>\n                      </div>\n                      {/* <div className=\"reviewRight\">\n                                  </div> */}\n                    </div>\n                    <div className=\"reviewBar\">\n                      <div className=\"singleReview\">\n                        <p className=\"singleReviewText\">{text}</p>\n                      </div>\n                    </div>\n                    <div className=\"reviewInfo clearfix\">\n                      <div className=\"left\">\n                        <em>{replyCount} replies</em>\n                      </div>\n                      <div className=\"right\">\n                        {/* <a\n                          href=\"javascript:void(0)\"\n                          className=\"reply\"\n                          onClick={(e) => data.onCommentClicked(e)}\n                        >\n                          Reply\n                        </a> */}\n                      </div>\n                    </div>\n                    {repliesData && repliesData.length > 0 ? (\n                      <>\n                        {repliesData &&\n                          repliesData.map((item, i) => {\n                            //   console.log(\"repliesData\", item);\n                            let profileImg = item && item.userInfo && item.userInfo.profilePictureUrl;\n                            const sourceIcon = profileImg;\n                            let profileName = item && item.userInfo && item.userInfo.userName;\n                            let time = item && item.userInfo && item.time;\n                            let text = item && item.userInfo && item.text;\n                            let replyCount = item && item.userInfo && item.replyCount;\n                            // let totalLikeCount = item && item.totalLikeCount;\n                            return (\n                              <>\n                                <div className=\"replies\" style={{ padding: \"0 16px\" }}>\n                                  <div className=\"reviews clearfix\">\n                                    <div className=\"reviewLeft\">\n                                      <div className=\"reviewPic\">\n                                        <img\n                                          src={sourceIcon.replace(\n                                            \"#DH_EMB_IMG_REP#__DHQ_\",\n                                            DhProperties.iconSize || \"100x200_80\"\n                                          )}\n                                          alt=\"\"\n                                        />\n                                      </div>\n                                      <div className=\"info\">\n                                        {profileName && <span>{profileName}</span>}\n                                        <em>{data.formatSeconds(time)}</em>\n                                      </div>\n                                    </div>\n                                  </div>\n                                  <div className=\"reviewBar\">\n                                    <div className=\"singleReview\">\n                                      <p className=\"singleReviewText\">{text}</p>\n                                    </div>\n                                  </div>\n                                  <div className=\"reviewInfo clearfix\">\n                                    <div className=\"left\">\n                                      <em>{replyCount} replies</em>\n                                    </div>\n                                    <div className=\"right\">\n                                      {/* <a\n                                        href=\"javascript:void(0)\"\n                                        className=\"reply\"\n                                        onClick={(e) => data.onCommentClicked(e)}\n                                      >\n                                        Reply\n                                      </a> */}\n                                    </div>\n                                  </div>\n                                </div>\n                              </>\n                            );\n                          })}\n                      </>\n                    ) : null}\n                  </>\n                ) : null}\n              </>\n            );\n          })}\n      </ReviewCard>\n    </>\n  );\n}\n\n\n\n\n"],"names":["CommentListing","props","nextPageUrl","state","setState","loading","fetch","then","response","json","data","code","tempRows","rows","UpdatedRows","commentDataRows","nextPageInProgress","commentData","ApiErrorCode","e","preventDefault","stopPropagation","story","id","dhPostId","deeplinkUrl","DhProperties","seo_url","sectionAndNamespace","undefined","format","payload","section","referrer","referrerId","commentParams","namespace","commentDeeplink","encodeURIComponent","JSON","stringify","newsHuntAction","handleAction","time","calculateTimeDiff","short_url","currentTab","countfordiscussion","commentBaseUrl","replace","this","length","emitReviewCount","loadFuncOnScrollEnd","push","onScrollEnd","err","console","log","publishedTimeMs","display","timeMs","Date","getTime","Math","round","parseInt","sectionTitle","SeactionHeader","LHS","H2","sectionId","RHS","onClick","onCommentClicked","CommentCard","formatSeconds","Loader","React","Component","ReviewCard","className","style","paddingTop","map","item","i","userInfo","sourceIcon","profilePictureUrl","profileName","userName","text","replyCount","repliesData","totalLikeCount","replies","src","iconSize","alt","padding"],"sourceRoot":""}